# üìä API GraphQL

> **Documenta√ß√£o Completa da API GraphQL do SmartEconomy Backend**

## üìã **√çndice**

- [üéØ Vis√£o Geral](#-vis√£o-geral)
- [üöÄ Quick Start](#-quick-start)
- [üìä Schema GraphQL](#-schema-graphql)
- [üîç Queries](#-queries)
- [‚úèÔ∏è Mutations](#Ô∏è-mutations)
- [üìù Types](#-types)
- [üîß Resolvers](#-resolvers)
- [üß™ Testando a API](#-testando-a-api)
- [üìö Exemplos Pr√°ticos](#-exemplos-pr√°ticos)
- [‚ö†Ô∏è Tratamento de Erros](#Ô∏è-tratamento-de-erros)
- [üîí Autentica√ß√£o](#-autentica√ß√£o)
- [üìà Performance](#-performance)

## üéØ **Vis√£o Geral**

A **API GraphQL** do SmartEconomy Backend oferece uma interface moderna e flex√≠vel para acesso aos dados do sistema. Constru√≠da com **Apollo Server** e **NestJS**, a API segue os princ√≠pios da arquitetura hexagonal e DDD.

### **Caracter√≠sticas Principais**

- ‚úÖ **Schema auto-gerado** a partir dos resolvers
- ‚úÖ **Valida√ß√£o robusta** com class-validator
- ‚úÖ **Tratamento de erros** consistente
- ‚úÖ **Logging estruturado** para todas as opera√ß√µes
- ‚úÖ **Performance otimizada** com DataLoader
- ‚úÖ **Documenta√ß√£o interativa** com GraphQL Playground

### **Endpoints Dispon√≠veis**

- **GraphQL Playground**: http://localhost:3000/graphql
- **GraphQL Endpoint**: http://localhost:3000/graphql
- **Health Check**: http://localhost:3000/health

## üöÄ **Quick Start**

### **1. Acesse o GraphQL Playground**

```bash
# Inicie o projeto
docker-compose up -d

# Acesse o playground
open http://localhost:3000/graphql
```

### **2. Teste uma Query Simples**

```graphql
query {
  hello
}
```

### **3. Explore o Schema**

No GraphQL Playground, clique em **"DOCS"** para explorar:
- **Types**: Todos os tipos dispon√≠veis
- **Queries**: Opera√ß√µes de leitura
- **Mutations**: Opera√ß√µes de escrita

## üìä **Schema GraphQL**

### **Schema Principal**

```graphql
# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type Gender {
  id: ID!
  gender: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type Profession {
  id: ID!
  profession: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type User {
  id: ID!
  email: String!
  name: String!
  lastname: String!
  birthdate: DateTime!
  role: String!
  genderId: String
  professionId: String
  profileId: String
  status: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type Account {
  id: ID!
  name: String!
  type: String!
  balance: Float!
  userId: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type SearchResult {
  items: [User!]!
  total: Int!
  currentPage: Int!
  limit: Int!
  totalPages: Int!
  lastPage: Int!
}

type Query {
  hello: String!
  users: [User!]!
  userById(id: String!): User
  userByEmail(email: String!): User
  searchUsers(input: SearchUsersInput!): SearchResult!
  
  # üí∞ Contas Financeiras
  accountsByUser(userId: String!): [Account!]!
  accountById(id: String!): Account
  
  genders: [Gender!]!
  professions: [Profession!]!
}

type Mutation {
  createUser(input: CreateUserInput!): User!
  updateUser(id: String!, input: UpdateUserInput!): User
  deleteUser(id: String!): Boolean!
  
  # üí∞ Contas Financeiras
  createAccount(input: CreateAccountInput!): Account!
}

input SearchUsersInput {
  page: Int = 1
  limit: Int = 10
  filter: String
  sort: String
  sortDirection: String = "asc"
}

input CreateUserInput {
  email: String!
  name: String!
  lastname: String!
  birthdate: String!
  role: String!
  genderId: String!
  professionId: String!
  password: String!
}

input UpdateUserInput {
  email: String
  name: String
  lastname: String
  password: String
}

input CreateAccountInput {
  name: String!
  type: String!
  balance: Float
  userId: String!
}

scalar DateTime
```

### **Tipos de Dados**

#### **Scalars**
- **ID**: Identificador √∫nico
- **String**: Texto
- **Int**: N√∫mero inteiro
- **Boolean**: Valor booleano
- **DateTime**: Data e hora

#### **Enums**
```typescript
enum UserRole {
  USER = 'USER'
  ADMIN = 'ADMIN'
}

enum AccountStatus {
  ACTIVE = 'ACTIVE'
  INACTIVE = 'INACTIVE'
  SUSPENDED = 'SUSPENDED'
}

enum AccountType {
  CHECKING = 'CHECKING'       // Conta Corrente
  SAVINGS = 'SAVINGS'         // Conta Poupan√ßa
  INVESTMENT = 'INVESTMENT'   // Conta de Investimento
  CREDIT_CARD = 'CREDIT_CARD' // Cart√£o de Cr√©dito
  WALLET = 'WALLET'           // Carteira
}
```

## üîç **Queries**

### **1. Hello Query**

```graphql
query {
  hello
}
```

**Resposta:**
```json
{
  "data": {
    "hello": "Hello World!"
  }
}
```

### **2. Buscar Todos os Usu√°rios**

```graphql
query {
  users {
    id
    email
    name
    lastname
    role
    status
    createdAt
  }
}
```

**Resposta:**
```json
{
  "data": {
    "users": [
      {
        "id": "user_1234567890_abc123",
        "email": "joao.silva@example.com",
        "name": "Jo√£o",
        "lastname": "Silva",
        "role": "USER",
        "status": "ACTIVE",
        "createdAt": "2025-01-15T10:30:00.000Z"
      }
    ]
  }
}
```

### **3. Buscar Usu√°rio por ID**

```graphql
query GetUserById($id: String!) {
  userById(id: $id) {
    id
    email
    name
    lastname
    birthdate
    role
    status
    createdAt
    updatedAt
  }
}
```

**Variables:**
```json
{
  "id": "user_1234567890_abc123"
}
```

### **4. Buscar Usu√°rio por Email**

```graphql
query GetUserByEmail($email: String!) {
  userByEmail(email: $email) {
    id
    email
    name
    lastname
    role
    status
  }
}
```

**Variables:**
```json
{
  "email": "joao.silva@example.com"
}
```

### **5. Busca Avan√ßada de Usu√°rios**

```graphql
query SearchUsers($input: SearchUsersInput!) {
  searchUsers(input: $input) {
    items {
      id
      email
      name
      lastname
      role
      status
    }
    total
    currentPage
    limit
    totalPages
    lastPage
  }
}
```

**Variables:**
```json
{
  "input": {
    "page": 1,
    "limit": 10,
    "filter": "jo√£o",
    "sort": "name",
    "sortDirection": "asc"
  }
}
```

### **6. Buscar G√™neros**

```graphql
query {
  genders {
    id
    gender
    createdAt
    updatedAt
  }
}
```

### **7. Buscar Profiss√µes**

```graphql
query {
  professions {
    id
    profession
    createdAt
    updatedAt
  }
}
```

### **8. üí∞ Buscar Contas por Usu√°rio**

```graphql
query AccountsByUser($userId: String!) {
  accountsByUser(userId: $userId) {
    id
    name
    type
    balance
    createdAt
    updatedAt
  }
}
```

**Variables:**
```json
{
  "userId": "user-uuid-here"
}
```

**Resposta:**
```json
{
  "data": {
    "accountsByUser": [
      {
        "id": "account-uuid-1",
        "name": "Conta Corrente Principal",
        "type": "CHECKING",
        "balance": 1500.50,
        "createdAt": "2025-08-26T10:00:00.000Z",
        "updatedAt": "2025-08-26T10:00:00.000Z"
      },
      {
        "id": "account-uuid-2",
        "name": "Conta Poupan√ßa",
        "type": "SAVINGS",
        "balance": 5000.00,
        "createdAt": "2025-08-26T10:05:00.000Z",
        "updatedAt": "2025-08-26T10:05:00.000Z"
      }
    ]
  }
}
```

### **9. üí∞ Buscar Conta por ID**

```graphql
query AccountById($id: String!) {
  accountById(id: $id) {
    id
    name
    type
    balance
    userId
    createdAt
    updatedAt
  }
}
```

**Variables:**
```json
{
  "id": "account-uuid-here"
}
```

**Resposta:**
```json
{
  "data": {
    "accountById": {
      "id": "account-uuid-1",
      "name": "Conta Corrente Principal",
      "type": "CHECKING",
      "balance": 1500.50,
      "userId": "user-uuid-here",
      "createdAt": "2025-08-26T10:00:00.000Z",
      "updatedAt": "2025-08-26T10:00:00.000Z"
    }
  }
}
```

## ‚úèÔ∏è **Mutations**

### **1. Criar Usu√°rio**

```graphql
mutation CreateUser($input: CreateUserInput!) {
  createUser(input: $input) {
    id
    email
    name
    lastname
    birthdate
    role
    status
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "email": "maria.santos@example.com",
    "name": "Maria",
    "lastname": "Santos",
    "birthdate": "1992-08-15",
    "role": "USER",
    "genderId": "gender-uuid-here",
    "professionId": "profession-uuid-here",
    "password": "SecurePass123!"
  }
}
```

**Resposta de Sucesso:**
```json
{
  "data": {
    "createUser": {
      "id": "user_1234567890_def456",
      "email": "maria.santos@example.com",
      "name": "Maria",
      "lastname": "Santos",
      "birthdate": "1992-08-15T00:00:00.000Z",
      "role": "USER",
      "status": "ACTIVE",
      "createdAt": "2025-01-15T10:35:00.000Z"
    }
  }
}
```

**Resposta de Erro:**
```json
{
  "errors": [
    {
      "message": "User with email maria.santos@example.com already exists",
      "extensions": {
        "code": "USER_EMAIL_ALREADY_EXISTS",
        "statusCode": 400
      }
    }
  ]
}
```

### **2. Atualizar Usu√°rio**

```graphql
mutation UpdateUser($id: String!, $input: UpdateUserInput!) {
  updateUser(id: $id, input: $input) {
    id
    name
    lastname
    updatedAt
  }
}
```

**Variables:**
```json
{
  "id": "user_1234567890_abc123",
  "input": {
    "name": "Jo√£o Pedro",
    "lastname": "Silva Santos"
  }
}
```

### **3. Deletar Usu√°rio**

```graphql
mutation DeleteUser($id: String!) {
  deleteUser(id: $id)
}
```

**Variables:**
```json
{
  "id": "user_1234567890_abc123"
}
```

**Resposta:**
```json
{
  "data": {
    "deleteUser": true
  }
}
```

### **4. üí∞ Criar Conta Financeira**

```graphql
mutation CreateAccount($input: CreateAccountInput!) {
  createAccount(input: $input) {
    id
    name
    type
    balance
    userId
    createdAt
  }
}
```

**Variables para Conta Corrente:**
```json
{
  "input": {
    "name": "Conta Corrente Principal",
    "type": "CHECKING",
    "balance": 1500.50,
    "userId": "user-uuid-here"
  }
}
```

**Variables para Conta Poupan√ßa:**
```json
{
  "input": {
    "name": "Conta Poupan√ßa",
    "type": "SAVINGS",
    "balance": 5000.00,
    "userId": "user-uuid-here"
  }
}
```

**Variables para Cart√£o de Cr√©dito:**
```json
{
  "input": {
    "name": "Cart√£o Visa Gold",
    "type": "CREDIT_CARD",
    "balance": 0.00,
    "userId": "user-uuid-here"
  }
}
```

**Resposta de Sucesso:**
```json
{
  "data": {
    "createAccount": {
      "id": "account-uuid-new",
      "name": "Conta Corrente Principal",
      "type": "CHECKING",
      "balance": 1500.50,
      "userId": "user-uuid-here",
      "createdAt": "2025-08-26T10:30:00.000Z"
    }
  }
}
```

**Resposta de Erro:**
```json
{
  "errors": [
    {
      "message": "User not found",
      "extensions": {
        "code": "USER_NOT_FOUND",
        "statusCode": 404
      }
    }
  ]
}
```

## üìù **Types**

### **User Type**

```graphql
type User {
  id: ID!
  email: String!
  name: String!
  lastname: String!
  birthdate: DateTime!
  role: String!
  genderId: String
  professionId: String
  profileId: String
  status: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}
```

### **üí∞ Account Type**

```graphql
type Account {
  id: ID!
  name: String!
  type: String!
  balance: Float!
  userId: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}
```

### **SearchResult Type**

```graphql
type SearchResult {
  items: [User!]!
  total: Int!
  currentPage: Int!
  limit: Int!
  totalPages: Int!
  lastPage: Int!
}
```

### **Input Types**

#### **CreateUserInput**
```graphql
input CreateUserInput {
  email: String!
  name: String!
  lastname: String!
  birthdate: String!
  role: String!
  genderId: String!
  professionId: String!
  password: String!
}
```

#### **UpdateUserInput**
```graphql
input UpdateUserInput {
  email: String
  name: String
  lastname: String
  password: String
}
```

#### **SearchUsersInput**
```graphql
input SearchUsersInput {
  page: Int = 1
  limit: Int = 10
  filter: String
  sort: String
  sortDirection: String = "asc"
}
```

#### **üí∞ CreateAccountInput**
```graphql
input CreateAccountInput {
  name: String!
  type: String!
  balance: Float
  userId: String!
}
```

## üîß **Resolvers**

### **UsersResolver**

```typescript
@Resolver(() => User)
export class UsersResolver {
    constructor(
        private readonly usersApplicationService: UsersApplicationService,
        private readonly loggerService: LoggerService
    ) {}

    @Query(() => [User])
    async users(): Promise<User[]> {
        try {
            this.loggerService.logOperation('GRAPHQL_GET_ALL_USERS_START', null, 'UsersResolver')

            const result = await this.usersApplicationService.searchUsers({
                page: 1,
                limit: 100
            })

            this.loggerService.logOperation('GRAPHQL_GET_ALL_USERS_SUCCESS',
                { count: result.users.length }, 'UsersResolver')

            return result.users
        } catch (error) {
            this.loggerService.logError('GRAPHQL_GET_ALL_USERS_ERROR', error, 'UsersResolver')
            throw error
        }
    }

    @Query(() => User, { nullable: true })
    async userById(@Args('id') id: string): Promise<User | null> {
        try {
            this.loggerService.logOperation('GRAPHQL_GET_USER_BY_ID_START', { id }, 'UsersResolver')

            const user = await this.usersApplicationService.findUserById(id)

            this.loggerService.logOperation('GRAPHQL_GET_USER_BY_ID_SUCCESS',
                { id: user.id, email: user.email }, 'UsersResolver')

            return user
        } catch (error) {
            this.loggerService.logError('GRAPHQL_GET_USER_BY_ID_ERROR', error, 'UsersResolver')
            return null
        }
    }

    @Mutation(() => User)
    async createUser(@Args('input') input: CreateUserInput): Promise<User> {
        try {
            this.loggerService.logOperation('GRAPHQL_CREATE_USER_START',
                { email: input.email }, 'UsersResolver')

            const user = await this.usersApplicationService.createUser({
                email: input.email,
                name: input.name,
                lastname: input.lastname,
                birthdate: input.birthdate,
                role: input.role as UserRole,
                genderId: input.genderId,
                professionId: input.professionId,
                password: input.password
            })

            this.loggerService.logOperation('GRAPHQL_CREATE_USER_SUCCESS',
                { id: user.id, email: user.email }, 'UsersResolver')

            return user
        } catch (error) {
            this.loggerService.logError('GRAPHQL_CREATE_USER_ERROR', error, 'UsersResolver')
            throw error
        }
    }
}
```

### **Caracter√≠sticas dos Resolvers**

- **Logging estruturado** para todas as opera√ß√µes
- **Tratamento de erros** consistente
- **Valida√ß√£o autom√°tica** com class-validator
- **Inje√ß√£o de depend√™ncia** com NestJS
- **Separa√ß√£o de responsabilidades** clara

## üß™ **Testando a API**

### **1. Com GraphQL Playground**

1. **Acesse**: http://localhost:3000/graphql
2. **Explore o schema** na aba "DOCS"
3. **Teste queries** na aba principal
4. **Configure vari√°veis** na aba "Query Variables"

### **2. Com Scripts de Teste**

```bash
# Teste queries b√°sicas
curl -s http://localhost:3000/graphql -H "Content-Type: application/json" -d '{"query":"query { users { id name email } }"}'

# Teste mutations
curl -s http://localhost:3000/graphql -H "Content-Type: application/json" -d '{"query":"mutation CreateUser($input: CreateUserInput!) { createUser(input: $input) { id email name } }","variables":{"input":{"email":"test@example.com","name":"Test","lastname":"User","birthdate":"1990-01-01","role":"USER","genderId":"gender-id","professionId":"profession-id","password":"password123"}}}'

# Teste com dados espec√≠ficos
curl -s http://localhost:3000/graphql -H "Content-Type: application/json" -d '{"query":"query GetUser($id: String!) { user(id: $id) { id name email } }","variables":{"id":"user-id"}}'
```

### **3. Com Postman**

1. **Importe a collection**: `postman_collection.json`
2. **Configure o ambiente** com vari√°veis
3. **Execute as requests** na sequ√™ncia correta

### **4. Com cURL**

```bash
# Query simples
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"query":"query { hello }"}' \
  http://localhost:3000/graphql

# Query com vari√°veis
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"query":"query GetUser($id: String!) { userById(id: $id) { id email name } }","variables":{"id":"user-123"}}' \
  http://localhost:3000/graphql
```

## üìö **Exemplos Pr√°ticos**

### **1. Fluxo Completo de Cria√ß√£o de Usu√°rio**

#### **Passo 1: Obter Dados de Suporte**
```graphql
query {
  genders {
    id
    gender
  }
  professions {
    id
    profession
  }
}
```

#### **Passo 2: Criar Usu√°rio**
```graphql
mutation CreateUser($input: CreateUserInput!) {
  createUser(input: $input) {
    id
    email
    name
    lastname
    role
    status
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "email": "admin@smarteconomy.com",
    "name": "Administrador",
    "lastname": "Sistema",
    "birthdate": "1985-05-20",
    "role": "ADMIN",
    "genderId": "gender-uuid-from-step-1",
  }
}
```

### **4. üí∞ Fluxo Completo: Usu√°rio + Contas Financeiras**

#### **Passo 1: Criar Usu√°rio**
```graphql
mutation CreateUser($input: CreateUserInput!) {
  createUser(input: $input) {
    id
    email
    name
    lastname
    role
    status
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "email": "cliente@smarteconomy.com",
    "name": "Maria",
    "lastname": "Silva",
    "birthdate": "1990-03-15",
    "role": "USER",
    "genderId": "gender-uuid-from-step-1",
    "professionId": "profession-uuid-from-step-1",
    "password": "Cliente123456!"
  }
}
```

#### **Passo 2: Criar Conta Corrente**
```graphql
mutation CreateCheckingAccount($input: CreateAccountInput!) {
  createAccount(input: $input) {
    id
    name
    type
    balance
    userId
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "name": "Conta Corrente Principal",
    "type": "CHECKING",
    "balance": 2500.00,
    "userId": "user-uuid-created-above"
  }
}
```

#### **Passo 3: Criar Conta Poupan√ßa**
```graphql
mutation CreateSavingsAccount($input: CreateAccountInput!) {
  createAccount(input: $input) {
    id
    name
    type
    balance
    userId
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "name": "Conta Poupan√ßa",
    "type": "SAVINGS",
    "balance": 10000.00,
    "userId": "user-uuid-created-above"
  }
}
```

#### **Passo 4: Criar Cart√£o de Cr√©dito**
```graphql
mutation CreateCreditCard($input: CreateAccountInput!) {
  createAccount(input: $input) {
    id
    name
    type
    balance
    userId
    createdAt
  }
}
```

**Variables:**
```json
{
  "input": {
    "name": "Cart√£o Mastercard Black",
    "type": "CREDIT_CARD",
    "balance": 0.00,
    "userId": "user-uuid-created-above"
  }
}
```

#### **Passo 5: Listar Todas as Contas do Usu√°rio**
```graphql
query GetAllUserAccounts($userId: String!) {
  accountsByUser(userId: $userId) {
    id
    name
    type
    balance
    createdAt
    updatedAt
  }
}
```

**Variables:**
```json
{
  "userId": "user-uuid-created-above"
}
```

**Resposta Esperada:**
```json
{
  "data": {
    "accountsByUser": [
      {
        "id": "account-uuid-1",
        "name": "Conta Corrente Principal",
        "type": "CHECKING",
        "balance": 2500.00,
        "createdAt": "2025-08-26T10:00:00.000Z",
        "updatedAt": "2025-08-26T10:00:00.000Z"
      },
      {
        "id": "account-uuid-2",
        "name": "Conta Poupan√ßa",
        "type": "SAVINGS",
        "balance": 10000.00,
        "createdAt": "2025-08-26T10:05:00.000Z",
        "updatedAt": "2025-08-26T10:05:00.000Z"
      },
      {
        "id": "account-uuid-3",
        "name": "Cart√£o Mastercard Black",
        "type": "CREDIT_CARD",
        "balance": 0.00,
        "createdAt": "2025-08-26T10:10:00.000Z",
        "updatedAt": "2025-08-26T10:10:00.000Z"
      }
    ]
  }
}
```

### **5. Atualiza√ß√£o de Perfil**

```graphql
query SearchUsersAdvanced($input: SearchUsersInput!) {
  searchUsers(input: $input) {
    items {
      id
      email
      name
      lastname
      role
      status
      createdAt
    }
    total
    currentPage
    totalPages
    lastPage
  }
}
```

**Variables para diferentes cen√°rios:**

#### **Busca por Nome**
```json
{
  "input": {
    "page": 1,
    "limit": 20,
    "filter": "jo√£o",
    "sort": "name",
    "sortDirection": "asc"
  }
}
```

#### **Busca por Email**
```json
{
  "input": {
    "page": 1,
    "limit": 10,
    "filter": "@gmail.com",
    "sort": "email",
    "sortDirection": "asc"
  }
}
```

#### **Pagina√ß√£o Avan√ßada**
```json
{
  "input": {
    "page": 2,
    "limit": 5,
    "sort": "createdAt",
    "sortDirection": "desc"
  }
}
```

### **3. Atualiza√ß√£o de Perfil**

```graphql
mutation UpdateUserProfile($id: String!, $input: UpdateUserInput!) {
  updateUser(id: $id, input: $input) {
    id
    name
    lastname
    updatedAt
  }
}
```

**Variables:**
```json
{
  "id": "user-uuid-here",
  "input": {
    "name": "Jo√£o Pedro",
    "lastname": "Silva Santos"
  }
}
```

## ‚ö†Ô∏è **Tratamento de Erros**

### **Tipos de Erro**

#### **1. Erros de Valida√ß√£o**
```json
{
  "errors": [
    {
      "message": "User must be at least 18 years old",
      "extensions": {
        "code": "USER_INVALID_AGE",
        "statusCode": 400
      }
    }
  ]
}
```

#### **2. Erros de Neg√≥cio**
```json
{
  "errors": [
    {
      "message": "User with email joao@example.com already exists",
      "extensions": {
        "code": "USER_EMAIL_ALREADY_EXISTS",
        "statusCode": 409
      }
    }
  ]
}
```

#### **3. Erros de Sistema**
```json
{
  "errors": [
    {
      "message": "Internal server error",
      "extensions": {
        "code": "INTERNAL_SERVER_ERROR",
        "statusCode": 500
      }
    }
  ]
}
```

### **C√≥digos de Erro**

| C√≥digo | Descri√ß√£o | Status HTTP |
|--------|-----------|-------------|
| `USER_EMAIL_ALREADY_EXISTS` | Email j√° cadastrado | 409 |
| `USER_NOT_FOUND` | Usu√°rio n√£o encontrado | 404 |
| `USER_INVALID_AGE` | Idade inv√°lida | 400 |
| `USER_INVALID_EMAIL` | Email inv√°lido | 400 |
| `USER_INVALID_PASSWORD` | Senha inv√°lida | 400 |
| `ACCOUNT_NOT_FOUND` | Conta n√£o encontrada | 404 |
| `ACCOUNT_INVALID_TYPE` | Tipo de conta inv√°lido | 400 |
| `ACCOUNT_INVALID_BALANCE` | Saldo inv√°lido | 400 |
| `ACCOUNT_INSUFFICIENT_BALANCE` | Saldo insuficiente | 400 |
| `INVALID_INPUT` | Dados de entrada inv√°lidos | 400 |
| `INTERNAL_SERVER_ERROR` | Erro interno do servidor | 500 |

## üîí **Autentica√ß√£o**

### **Status Atual**

- ‚úÖ **Autentica√ß√£o JWT** implementada
- ‚úÖ **Middleware de autentica√ß√£o** configurado
- ‚úÖ **Guards de autoriza√ß√£o** dispon√≠veis
- üîÑ **GraphQL Auth** em desenvolvimento

### **Implementa√ß√£o Futura**

```typescript
// Exemplo de resolver protegido
@Query(() => [User])
@UseGuards(GqlAuthGuard)
@Roles(UserRole.ADMIN)
async adminUsers(): Promise<User[]> {
    return this.usersApplicationService.getAllUsers()
}
```

## üìà **Performance**

### **Otimiza√ß√µes Implementadas**

- ‚úÖ **DataLoader** para evitar N+1 queries
- ‚úÖ **Caching** em camadas apropriadas
- ‚úÖ **Lazy loading** de relacionamentos
- ‚úÖ **Query optimization** com Prisma

### **Monitoramento**

- üìä **Logs estruturados** para todas as opera√ß√µes
- ‚è±Ô∏è **M√©tricas de performance** com interceptors
- üîç **Query analysis** com Prisma Studio
- üìà **Health checks** para servi√ßos

### **Boas Pr√°ticas**

1. **Use proje√ß√µes espec√≠ficas** para evitar over-fetching
2. **Implemente pagina√ß√£o** para listas grandes
3. **Use filtros** para reduzir dados transferidos
4. **Monitore queries** com Prisma Studio
5. **Implemente caching** para dados est√°ticos

## üéØ **Conclus√£o**

A **API GraphQL** do SmartEconomy Backend oferece:

- **üöÄ Interface moderna** e flex√≠vel
- **üìä Schema auto-gerado** e documentado
- **üîí Valida√ß√£o robusta** e tratamento de erros
- **üìà Performance otimizada** com DataLoader
- **üß™ Testabilidade** com playground interativo
- **üìö Documenta√ß√£o completa** e exemplos pr√°ticos

Esta implementa√ß√£o segue as **melhores pr√°ticas** do GraphQL e serve como **base s√≥lida** para o crescimento da API.

---

**üìñ Para mais detalhes, consulte:**
- [Arquitetura Hexagonal](../architecture/hexagonal.md)
- [Domain-Driven Design](../architecture/ddd.md)
- [Guia Postman](../../GUIA_POSTMAN.md)
- [M√≥dulo Users](../../src/users/README.md)
